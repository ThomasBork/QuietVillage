!function(e){var t={};function s(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=2)}([function(e,t){e.exports=React},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Devotion=0]="Devotion",e[e.Food=1]="Food",e[e.Gold=2]="Gold",e[e.Pelt=3]="Pelt",e[e.Stone=4]="Stone",e[e.Wood=5]="Wood"}(t.ResourceType||(t.ResourceType={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),o=s(3),i=s(4);let n=s(8).Game.new();o.render(r.createElement(i.UIGame,{game:n}),document.getElementById("game-container"))},function(e,t){e.exports=ReactDOM},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),o=s(5);class i extends r.Component{constructor(e){super(e)}render(){return r.createElement("div",null,r.createElement("input",{type:"button",value:"Add player",onClick:e=>console.log("hej")}),r.createElement(o.UIResourceList,{game:this.props.game}))}}t.UIGame=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),o=s(6);class i extends r.Component{constructor(e){super(e);const t=()=>this.props.game.resourceSystem.resources.map(e=>({name:e.name,amount:e.amount}));this.state={resources:t()},this.props.game.onUpdated.addSubscription(this,()=>this.setState({resources:t()}))}render(){return r.createElement("ul",null,this.state.resources.map(e=>r.createElement(o.UIResourceLine,{key:e.name,name:e.name,amount:e.amount})))}}t.UIResourceList=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),o=s(7);class i extends r.Component{constructor(e){super(e)}render(){return r.createElement("li",null,this.props.name," - ",o.NumberFormatter.Format(this.props.amount,2,2))}}t.UIResourceLine=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NumberFormatter=class{static Format(e,t,s,r){void 0===t&&(t=2),void 0===s&&(s=t),void 0===r&&(r=!1);const o=Math.pow(10,t);let i;return r?(e-=1e-4,i=Math.ceil(e*o)/o):(e+=1e-4,i=Math.floor(e*o)/o),s?i.toFixed(s):i.toString()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(9),o=s(11),i=s(1);class n{constructor(){this.updateFrequency=100,this.maxTimeToResumePerUpdate=864e5,this.lastUpdateAsNumber=Date.now(),this.onUpdated=r.ObservableFactory.create()}static new(){const e=new n;return e.init(),e.start(),e}init(){this.resourceSystem=new o.ResourceSystem,this.resourceSystem.init(),this.resourceSystem.getResource(i.ResourceType.Gold).income.addAdditiveModifier(this,2),this.resourceSystem.getResource(i.ResourceType.Wood).income.addAdditiveModifier(this,5)}start(){this.startTimeAsNumber=Date.now(),this.beginUpdating()}beginUpdating(){this.updateIntervalID=setInterval(()=>{this.update()},this.updateFrequency)}update(){let e=Date.now()-this.lastUpdateAsNumber;for(e>this.maxTimeToResumePerUpdate&&(e=this.maxTimeToResumePerUpdate,this.lastUpdateAsNumber=Date.now()-this.maxTimeToResumePerUpdate);e>this.updateFrequency;)e-=this.updateFrequency,this.lastUpdateAsNumber=this.lastUpdateAsNumber+this.updateFrequency,this.updateGameSystems(this.updateFrequency);this.onUpdated.notify()}updateGameSystems(e){this.resourceSystem.update(e)}}t.Game=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(10);class o{constructor(){this.subscriptions=[]}static create(){return new o}static createWith1Argument(){return new o}static createWith2Arguments(){return new o}addSubscription(e,t){const s=new r.ObservableSubscription(e,t);this.subscriptions.push(s)}removeSubscription(e){this.subscriptions=this.subscriptions.filter(t=>t.observer!==e)}notify(...e){this.subscriptions.forEach(t=>t.callback.apply(t.observer,e))}}t.ObservableFactory=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ObservableSubscription=class{constructor(e,t){this.observer=e,this.callback=t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(12),o=s(1);t.ResourceSystem=class{constructor(){this.resources=[]}addResourceType(e,t){this.resources.push(new r.Resource(e,t))}init(){this.addResourceType("Food",o.ResourceType.Food),this.addResourceType("Wood",o.ResourceType.Wood),this.addResourceType("Stone",o.ResourceType.Stone),this.addResourceType("Pelt",o.ResourceType.Pelt),this.addResourceType("Gold",o.ResourceType.Gold),this.addResourceType("Devotion",o.ResourceType.Devotion)}getResource(e){return this.resources.find(t=>t.type===e)}update(e){this.resources.forEach(t=>{const s=t.income.value*e/1e3;t.amount+=s})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(13);t.Resource=class{constructor(e,t){this.amount=0,this.income=new r.ValueContainer,this.name=e,this.type=t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){this.amount=t,this.sourceObject=e}}t.ValueContainer=class{constructor(){this.additiveModifiers=[],this.multiplicativeModifiers=[],this.value=0}recalculateValue(){let e=0;this.additiveModifiers.forEach(t=>e+=t.amount),this.multiplicativeModifiers.forEach(t=>e*=t.amount),this.value=e}addAdditiveModifier(e,t){const s=new r(e,t);this.additiveModifiers.push(s),this.recalculateValue()}addMultiplicativeModifier(e,t){const s=new r(e,t);this.multiplicativeModifiers.push(s),this.recalculateValue()}removeAllModifiers(e){this.additiveModifiers=this.additiveModifiers.filter(t=>t.sourceObject!==e),this.multiplicativeModifiers=this.multiplicativeModifiers.filter(t=>t.sourceObject!==e)}}}]);
//# sourceMappingURL=main.js.map