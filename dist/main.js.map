{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"React\"","webpack:///./src/game/resources/ResourceType.ts","webpack:///./src/rendering/react/index.tsx","webpack:///external \"ReactDOM\"","webpack:///./src/rendering/react/components/UIGame.tsx","webpack:///./src/rendering/react/components/UIResourceList.tsx","webpack:///./src/rendering/react/components/UIResourceLine.tsx","webpack:///./src/common/NumberFormatter.ts","webpack:///./src/game/Game.ts","webpack:///./src/common/Observable.ts","webpack:///./src/common/ObservableSubscription.ts","webpack:///./src/game/resources/ResourceSystem.ts","webpack:///./src/game/resources/Resource.ts","webpack:///./src/game/shared/ValueContainer.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","React","ResourceType","game","Game","new","ReactDOM","render","UIGame","document","getElementById","Component","props","super","type","onClick","e","console","log","UIResourceList","this","getResources","resourceSystem","resources","map","resource","amount","state","onUpdated","addSubscription","setState","UIResourceLine","NumberFormatter","Format","number","maxDecimals","minDecimals","ceil","undefined","multiplier","Math","pow","roundedNumber","floor","toFixed","toString","updateFrequency","maxTimeToResumePerUpdate","lastUpdateAsNumber","Date","now","ObservableFactory","init","start","ResourceSystem","getResource","Gold","income","addAdditiveModifier","Wood","startTimeAsNumber","beginUpdating","updateIntervalID","setInterval","update","timeSinceLastUpdate","updateGameSystems","notify","dTime","subscriptions","observer","callback","subscription","ObservableSubscription","push","filter","args","forEach","apply","Resource","addResourceType","Food","Stone","Pelt","Devotion","find","dAmount","ValueContainer","ValueModifier","sourceObject","additiveModifiers","multiplicativeModifiers","newValue","mod","modifier","recalculateValue"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = React;","export enum ResourceType {\r\n    Devotion,\r\n    Food,\r\n    Gold,\r\n    Pelt,\r\n    Stone,\r\n    Wood\r\n}","import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport { UIGame } from \"./components/UIGame\";\r\nimport { Game } from \"../../game/Game\";\r\nlet game = Game.new();\r\n\r\nReactDOM.render(\r\n    <UIGame game={game} />,\r\n    document.getElementById(\"game-container\")\r\n);","module.exports = ReactDOM;","import * as React from \"react\";\r\nimport { Game } from \"../../../game/Game\";\r\nimport { UIResourceList } from \"./UIResourceList\";\r\n\r\nexport class UIGame extends React.Component<{game: Game}, {}> {\r\n    constructor (props: {game: Game}) {\r\n        super(props);\r\n    }\r\n    render() {\r\n        return (\r\n            <div>\r\n                <input type=\"button\" value=\"Add player\" onClick={(e) => console.log(\"hej\")}/>\r\n                <UIResourceList game={this.props.game}></UIResourceList>\r\n            </div>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Game } from \"../../../game/Game\";\r\nimport { UIResourceLine } from \"./UIResourceLine\";\r\n\r\ninterface ResourceLine {\r\n    name: string,\r\n    amount: number\r\n}\r\nexport class UIResourceList extends React.Component<{game: Game}, {resources: ResourceLine[]}> {\r\n    constructor (props: {game: Game}) {\r\n        super(props);\r\n\r\n        const getResources = () => this.props.game.resourceSystem.resources.map(resource => {\r\n            return {\r\n                name: resource.name, \r\n                amount: resource.amount\r\n            };\r\n        });\r\n\r\n        this.state = {resources: getResources()};\r\n\r\n        this.props.game.onUpdated.addSubscription(\r\n            this, \r\n            () => this.setState({resources: getResources()})\r\n        );\r\n    }\r\n    render() {\r\n        return (\r\n            <ul>\r\n            {this.state.resources.map((resource) => \r\n                <UIResourceLine key={resource.name} name={resource.name} amount={resource.amount}></UIResourceLine>\r\n            )}\r\n            </ul>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { NumberFormatter } from \"../../../common/NumberFormatter\";\r\n\r\nexport class UIResourceLine extends React.Component<{name: string, amount: number}> {\r\n    constructor (props: {name: string, amount: number}) {\r\n        super(props);\r\n    }\r\n    render() {\r\n        return (\r\n            <li>{this.props.name} - {NumberFormatter.Format(this.props.amount, 2, 2)}</li>\r\n        );\r\n    }\r\n}","export class NumberFormatter {\r\n    public static Format(number: number, maxDecimals?: number, minDecimals?: number, ceil?: boolean): string {\r\n        if (maxDecimals === undefined) {\r\n            maxDecimals = 2;\r\n        }\r\n        if (minDecimals === undefined) {\r\n            minDecimals = maxDecimals;\r\n        }\r\n        if (ceil === undefined) {\r\n            ceil = false;\r\n        }\r\n        const multiplier = Math.pow(10, maxDecimals);\r\n        let roundedNumber;\r\n        if (ceil) {\r\n            number -= 0.0001; // Floating point fix.\r\n            roundedNumber = Math.ceil(number * multiplier) / multiplier;\r\n        } else {\r\n            number += 0.0001; // Floating point fix.\r\n            roundedNumber = Math.floor(number * multiplier) / multiplier;\r\n        }\r\n        if (minDecimals) {\r\n            return roundedNumber.toFixed(minDecimals);\r\n        } else {\r\n            return roundedNumber.toString();\r\n        }\r\n    }\r\n}","import { Observable, ObservableFactory } from \"../common/Observable\";\r\nimport { GameSystem } from \"./shared/GameSystem\";\r\nimport { ResourceSystem } from \"./resources/ResourceSystem\";\r\nimport { ResourceType } from \"./resources/ResourceType\";\r\n\r\nexport class Game {\r\n    private updateFrequency: number = 100;\r\n    private maxTimeToResumePerUpdate: number = 24 * 60 * 60 * 1000;\r\n\r\n    private updateIntervalID: number;\r\n    private lastUpdateAsNumber: number = Date.now();\r\n    \r\n    private startTimeAsNumber: number;\r\n\r\n    public resourceSystem: ResourceSystem;\r\n\r\n    public onUpdated: Observable = ObservableFactory.create();\r\n\r\n    public static new(): Game {\r\n        const game = new Game();\r\n        game.init();\r\n        game.start();\r\n        return game;\r\n    }\r\n\r\n    private constructor () {}\r\n\r\n    public init (): void {\r\n        this.resourceSystem = new ResourceSystem();\r\n        this.resourceSystem.init();\r\n\r\n        this.resourceSystem.getResource(ResourceType.Gold).income.addAdditiveModifier(this, 2);\r\n        this.resourceSystem.getResource(ResourceType.Wood).income.addAdditiveModifier(this, 5);\r\n    }\r\n\r\n    public start (): void {\r\n        this.startTimeAsNumber = Date.now();\r\n        this.beginUpdating();\r\n    }\r\n\r\n    private beginUpdating(): void {\r\n        this.updateIntervalID = setInterval(() => {\r\n            this.update();\r\n        }, this.updateFrequency);\r\n    }\r\n\r\n    private update (): void {\r\n        let timeSinceLastUpdate = Date.now() - this.lastUpdateAsNumber;\r\n\r\n        // Cap catch up duration\r\n        if (timeSinceLastUpdate > this.maxTimeToResumePerUpdate) {\r\n            timeSinceLastUpdate = this.maxTimeToResumePerUpdate;\r\n            this.lastUpdateAsNumber = Date.now() - this.maxTimeToResumePerUpdate;\r\n        }\r\n\r\n        // Update until caught up\r\n        while (timeSinceLastUpdate > this.updateFrequency) {\r\n            timeSinceLastUpdate -= this.updateFrequency;\r\n            this.lastUpdateAsNumber = this.lastUpdateAsNumber + this.updateFrequency;\r\n\r\n            this.updateGameSystems(this.updateFrequency);\r\n        }\r\n\r\n        this.onUpdated.notify();\r\n    }\r\n\r\n    private updateGameSystems (dTime: number): void {        \r\n        this.resourceSystem.update(dTime);\r\n    }\r\n}","import { ObservableSubscription } from \"./ObservableSubscription\";\r\n\r\nexport interface Observable {\r\n    addSubscription(observer: object, callback: () => void): void;\r\n    removeSubscription(observer: object): void;\r\n    notify(): void;\r\n}\r\nexport interface ObservableWith1Argument<T0> {\r\n    addSubscription(observer: object, callback: (p0: T0) => void): void;\r\n    removeSubscription(observer: object): void;\r\n    notify(p0: T0): void;\r\n}\r\nexport interface ObservableWith2Arguments<T0, T1> {\r\n    addSubscription(observer: object, callback: (p0: T0, p1: T1) => void): void;\r\n    removeSubscription(observer: object): void;\r\n    notify(p0: T0, p1: T1): void;\r\n}\r\n\r\nexport class ObservableFactory {\r\n    private subscriptions: ObservableSubscription[] = [];\r\n\r\n    private constructor() {}\r\n\r\n    public static create(): Observable {\r\n        return new ObservableFactory();\r\n    } \r\n    public static createWith1Argument<T0>(): ObservableWith1Argument<T0> {\r\n        return new ObservableFactory();\r\n    } \r\n    public static createWith2Arguments<T0, T1>(): ObservableWith2Arguments<T0, T1> {\r\n        return new ObservableFactory();\r\n    }\r\n\r\n    public addSubscription (observer: object, callback: (...args: any[]) => void): void {\r\n        const subscription = new ObservableSubscription(observer, callback);\r\n        this.subscriptions.push (subscription);\r\n    }\r\n\r\n    public removeSubscription (observer: object): void {\r\n        this.subscriptions = this.subscriptions.filter(s => s.observer !== observer);\r\n    }\r\n\r\n    public notify (...args: any[]): void {\r\n        this.subscriptions.forEach(subscription => subscription.callback.apply(subscription.observer, args));\r\n    }\r\n}","export class ObservableSubscription {\r\n    public observer: object;\r\n    public callback: (...args: any[]) => void;\r\n    public constructor (observer: object, callback: (...args: any[]) => void) {\r\n        this.observer = observer;\r\n        this.callback = callback;\r\n    }\r\n}","import { GameSystem } from \"../shared/GameSystem\";\r\nimport { Resource } from \"./Resource\";\r\nimport { ResourceType } from \"./ResourceType\";\r\n\r\nexport class ResourceSystem implements GameSystem {\r\n    public resources: Resource[] = [];\r\n    private addResourceType(name: string, type: ResourceType): void {\r\n        this.resources.push(new Resource(name, type));\r\n    }\r\n    public init(): void {\r\n        this.addResourceType(\"Food\", ResourceType.Food);\r\n        this.addResourceType(\"Wood\", ResourceType.Wood);\r\n        this.addResourceType(\"Stone\", ResourceType.Stone);\r\n        this.addResourceType(\"Pelt\", ResourceType.Pelt);\r\n        this.addResourceType(\"Gold\", ResourceType.Gold);\r\n        this.addResourceType(\"Devotion\", ResourceType.Devotion);\r\n    }\r\n    public getResource(type: ResourceType): Resource {\r\n        return this.resources.find(r => r.type === type);\r\n    }\r\n    public update(dTime: number): void {\r\n        this.resources.forEach(resource => {\r\n            const dAmount = resource.income.value * dTime / 1000;\r\n            resource.amount += dAmount;\r\n        });\r\n    }\r\n}","import { ValueContainer } from \"../shared/ValueContainer\";\r\nimport { ResourceType } from \"./ResourceType\";\r\n\r\nexport class Resource {\r\n    public amount: number = 0;\r\n    public income: ValueContainer = new ValueContainer();\r\n    public name: string;\r\n    public type: ResourceType;\r\n    public constructor(name: string, type: ResourceType) {\r\n        this.name = name;\r\n        this.type = type;\r\n    }\r\n}","class ValueModifier {\r\n    public amount: number;\r\n    public sourceObject: object;\r\n\r\n    constructor (sourceObject: object, amount: number) {\r\n        this.amount = amount;\r\n        this.sourceObject = sourceObject;\r\n    }\r\n}\r\n\r\nexport class ValueContainer {\r\n    private additiveModifiers: ValueModifier[] = [];\r\n    private multiplicativeModifiers: ValueModifier[] = [];\r\n    public value = 0;\r\n    public recalculateValue (): void {\r\n        let newValue = 0;\r\n        this.additiveModifiers.forEach(mod => newValue += mod.amount);\r\n        this.multiplicativeModifiers.forEach(mod => newValue *= mod.amount);\r\n        this.value = newValue;\r\n    }\r\n    public addAdditiveModifier (sourceObject: object, amount: number) {\r\n        const modifier = new ValueModifier(sourceObject, amount);\r\n        this.additiveModifiers.push(modifier);\r\n        this.recalculateValue();\r\n    }\r\n    public addMultiplicativeModifier (sourceObject: object, amount: number) {\r\n        const modifier = new ValueModifier(sourceObject, amount);\r\n        this.multiplicativeModifiers.push(modifier);\r\n        this.recalculateValue();\r\n    }\r\n    public removeAllModifiers (sourceObject: object): void {\r\n        this.additiveModifiers = this.additiveModifiers.filter(mod => mod.sourceObject !== sourceObject);\r\n        this.multiplicativeModifiers = this.multiplicativeModifiers.filter(mod => mod.sourceObject !== sourceObject);\r\n    }\r\n}\r\n"],"sourceRoot":""}