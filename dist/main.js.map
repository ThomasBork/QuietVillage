{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"React\"","webpack:///./src/common/Observable.ts","webpack:///./src/game/shared/ValueContainer.ts","webpack:///./src/game/shared/GameSystem.ts","webpack:///./src/game/resources/ResourceType.ts","webpack:///./src/game/resources/ResourceValue.ts","webpack:///./src/rendering/react/index.tsx","webpack:///external \"ReactDOM\"","webpack:///./src/rendering/react/components/UIGame.tsx","webpack:///./src/game/Game.ts","webpack:///./src/common/ObservableSubscription.ts","webpack:///./src/game/resources/ResourceSystem.ts","webpack:///./src/game/resources/Resource.ts","webpack:///./src/game/workers/WorkerSystem.ts","webpack:///./src/game/workers/ResourceJob.ts","webpack:///./src/game/workers/Job.ts","webpack:///./src/game/buildings/BuildingSystem.ts","webpack:///./src/game/buildings/Building.ts","webpack:///./src/rendering/react/components/UIGameContext.tsx","webpack:///./src/rendering/react/components/structure/UIHeader.tsx","webpack:///./src/rendering/react/components/structure/UIBody.tsx","webpack:///./src/rendering/react/components/workers/UIJobList.tsx","webpack:///./src/rendering/react/components/workers/UIJobLine.tsx","webpack:///./src/rendering/react/components/buildings/UIBuildings.tsx","webpack:///./src/rendering/react/components/buildings/UIBuilding.tsx","webpack:///./src/rendering/react/components/resources/UIResources.tsx","webpack:///./src/rendering/react/components/resources/UIResource.tsx","webpack:///./src/common/NumberFormatter.ts","webpack:///./src/rendering/react/components/structure/UIGameSystemTabs.tsx","webpack:///./src/rendering/react/components/structure/UIGameSystemTab.tsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","React","ObservableFactory","subscriptions","observer","callback","subscription","ObservableSubscription","this","push","filter","args","forEach","apply","ValueModifier","amount","additiveModifiers","multiplicativeModifiers","onValueChange","createWith1Argument","newValue","mod","notify","existingModifier","find","newModifier","recalculateValue","_isUnlocked","onUnlocked","dTime","ResourceType","resourceType","baseValue","ValueContainer","setAdditiveModifier","ReactDOM","render","UIGame","document","getElementById","Component","props","super","state","game","newGame","Game","new","buildingSystem","addSubscription","forceUpdate","setState","UIHeader","versionNumber","onNewGameClick","GameContext","Provider","UIBody","updateFrequency","maxTimeToResumePerUpdate","lastUpdateAsNumber","Date","now","onUpdated","init","startNewGame","BuildingSystem","resourceSystem","ResourceSystem","workerSystem","WorkerSystem","startTimeAsNumber","refreshSystemsIsUnlocked","refreshResourcesIsUnlocked","beginUpdating","updateIntervalID","setInterval","update","timeSinceLastUpdate","updateGameSystems","isUnlocked","totalWorkerCount","idleWorkerCount","GameSystem","resources","resourceMap","Map","resourceCaps","type","initialCap","Resource","addResourceType","Food","Wood","Stone","Pelt","Gold","Devotion","resource","set","dAmount","income","respectCap","resourceValues","every","resourceValue","getResource","cap","undefined","hasCap","_","recalculateIdleWorkerCount","gathererJob","ResourceJob","woodcutterJob","resourceJobs","jobs","job","onWorkerCountChange","workerCount","resourceIncomeFromJob","onIdleWorkerCountChange","newCount","dWorkerCount","Job","description","incomePerSecond","_workerCount","buildings","baseCost","additiveCostPerBuilding","multiplicativeCostPerBuilding","onUpdateAmount","Building","resourceValueInput","map","input","ResourceValue","addBuilding","buildResourceValues","thisBuilding","building","cost","getCostOfNextBuilding","hasResources","payResources","incrementAmount","costResource","Math","pow","setMultiplicativeModifier","createContext","id","className","onClick","selectedGameSystem","UIBuildings","UIJobList","UIGameSystemTabs","onSelected","system","renderGameSystem","UIResources","UIJobLine","newWorkerCount","setWorkers","setWorkerCountOnJob","addWorker","removeWorker","UIBuilding","buyBuilding","buy","getResources","UIResource","NumberFormatter","Format","number","maxDecimals","minDecimals","ceil","amountOfTimesTheNumberCanBeDividedBy1000","multiplier","roundedNumber","numberString","floor","toFixed","toString","postfix","postfixes","allGameSystems","gameSystems","getUnlockedGameSystems","gameSystem","selectGameSystem","UIGameSystemTab","isSelected","src","toLocaleLowerCase"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","module.exports = React;","import { ObservableSubscription } from \"./ObservableSubscription\";\r\n\r\nexport interface Observable {\r\n    addSubscription(observer: object, callback: () => void): void;\r\n    removeSubscription(observer: object): void;\r\n    notify(): void;\r\n}\r\nexport interface ObservableWith1Argument<T0> {\r\n    addSubscription(observer: object, callback: (p0: T0) => void): void;\r\n    removeSubscription(observer: object): void;\r\n    notify(p0: T0): void;\r\n}\r\nexport interface ObservableWith2Arguments<T0, T1> {\r\n    addSubscription(observer: object, callback: (p0: T0, p1: T1) => void): void;\r\n    removeSubscription(observer: object): void;\r\n    notify(p0: T0, p1: T1): void;\r\n}\r\n\r\nexport class ObservableFactory {\r\n    private subscriptions: ObservableSubscription[] = [];\r\n\r\n    private constructor() {}\r\n\r\n    public static create(): Observable {\r\n        return new ObservableFactory();\r\n    } \r\n    public static createWith1Argument<T0>(): ObservableWith1Argument<T0> {\r\n        return new ObservableFactory();\r\n    } \r\n    public static createWith2Arguments<T0, T1>(): ObservableWith2Arguments<T0, T1> {\r\n        return new ObservableFactory();\r\n    }\r\n\r\n    public addSubscription (observer: object, callback: (...args: any[]) => void): void {\r\n        const subscription = new ObservableSubscription(observer, callback);\r\n        this.subscriptions.push (subscription);\r\n    }\r\n\r\n    public removeSubscription (observer: object): void {\r\n        this.subscriptions = this.subscriptions.filter(s => s.observer !== observer);\r\n    }\r\n\r\n    public notify (...args: any[]): void {\r\n        this.subscriptions.forEach(subscription => subscription.callback.apply(subscription.observer, args));\r\n    }\r\n}","import { ObservableWith1Argument, ObservableFactory } from \"../../common/Observable\";\r\n\r\nclass ValueModifier {\r\n    public amount: number;\r\n    public key: any;\r\n\r\n    constructor (key: any, amount: number) {\r\n        this.amount = amount;\r\n        this.key = key;\r\n    }\r\n}\r\n\r\nexport class ValueContainer {\r\n    private additiveModifiers: ValueModifier[] = [];\r\n    private multiplicativeModifiers: ValueModifier[] = [];\r\n    public value = 0;\r\n    public onValueChange: ObservableWith1Argument<number> = ObservableFactory.createWith1Argument<number>();\r\n    public recalculateValue (): void {\r\n        let newValue = 0;\r\n        this.additiveModifiers.forEach(mod => newValue += mod.amount);\r\n        this.multiplicativeModifiers.forEach(mod => newValue *= mod.amount);\r\n        if (this.value !== newValue) {\r\n            this.value = newValue;\r\n            this.onValueChange.notify(newValue);\r\n        }\r\n    }\r\n    public setAdditiveModifier (key: any, amount: number) {\r\n        const existingModifier = this.additiveModifiers.find(mod => mod.key === key);\r\n        if (existingModifier) {\r\n            existingModifier.amount = amount;\r\n        } else {\r\n            const newModifier = new ValueModifier(key, amount);\r\n            this.additiveModifiers.push(newModifier);\r\n        }\r\n        this.recalculateValue();\r\n    }\r\n    public setMultiplicativeModifier (key: any, amount: number) {\r\n        const existingModifier = this.multiplicativeModifiers.find(mod => mod.key === key);\r\n        if (existingModifier) {\r\n            existingModifier.amount = amount;\r\n        } else {\r\n            const newModifier = new ValueModifier(key, amount);\r\n            this.multiplicativeModifiers.push(newModifier);\r\n        }\r\n        this.recalculateValue();\r\n    }\r\n    public removeAllModifiers (key: any): void {\r\n        this.additiveModifiers = this.additiveModifiers.filter(mod => mod.key !== key);\r\n        this.multiplicativeModifiers = this.multiplicativeModifiers.filter(mod => mod.key !== key);\r\n    }\r\n}\r\n","import { Observable, ObservableFactory } from \"../../common/Observable\";\r\n\r\nexport abstract class GameSystem {\r\n    private _isUnlocked: boolean = false;\r\n    public get isUnlocked(): boolean { return this._isUnlocked; };\r\n    public set isUnlocked(value) { \r\n        if (this._isUnlocked !== value) {\r\n            this._isUnlocked = value;\r\n            if (value) {\r\n                this.onUnlocked.notify();\r\n            }\r\n        }\r\n    };\r\n    public onUnlocked: Observable = ObservableFactory.create();\r\n    public update(dTime: number): void {}\r\n    public init(): void {}\r\n    public abstract name: string;\r\n}\r\n","export enum ResourceType {\r\n    Devotion,\r\n    Food,\r\n    Gold,\r\n    Pelt,\r\n    Stone,\r\n    Wood\r\n}","import { ResourceType } from \"./ResourceType\";\r\nimport { ValueContainer } from \"../shared/ValueContainer\";\r\n\r\nexport class ResourceValue {\r\n    public resourceType: ResourceType;\r\n    public value: ValueContainer;\r\n    public constructor (resourceType: ResourceType, baseValue: number) {\r\n        this.resourceType = resourceType;\r\n        this.value = new ValueContainer();\r\n        this.value.setAdditiveModifier(this, baseValue);\r\n    }\r\n}\r\n","import * as React from \"react\";\r\nimport * as ReactDOM from \"react-dom\";\r\n\r\nimport { UIGame } from \"./components/UIGame\";\r\n\r\nReactDOM.render(\r\n    <UIGame />,\r\n    document.getElementById(\"game-container\")\r\n);","module.exports = ReactDOM;","import * as React from \"react\";\r\nimport { Game } from \"../../../game/Game\";\r\nimport { UIResources } from \"./resources/UIResources\";\r\nimport { UIJobList } from \"./workers/UIJobList\";\r\nimport { GameContext } from \"./UIGameContext\";\r\nimport { UIBuildings } from \"./buildings/UIBuildings\";\r\nimport { UIHeader } from \"./structure/UIHeader\";\r\nimport { UIBody } from \"./structure/UIBody\";\r\n\r\nexport class UIGame extends React.Component<{}, {game: Game}> {\r\n    constructor (props: {game: Game}) {\r\n        super(props);\r\n\r\n        this.state = {game: null};\r\n    }\r\n    newGame() {\r\n        const newGame = Game.new();\r\n        newGame.buildingSystem.onUnlocked.addSubscription(this, () => this.forceUpdate());\r\n        this.setState({game: newGame});\r\n    }\r\n    render() {\r\n        return (\r\n            <div>\r\n                <UIHeader versionNumber={'0.0.1'} onNewGameClick={()=>this.newGame()}></UIHeader>\r\n                {\r\n                    this.state.game\r\n                    ? \r\n                    <GameContext.Provider value={this.state.game}>\r\n                        <UIBody game={this.state.game}></UIBody>\r\n                    </GameContext.Provider>\r\n                    : null\r\n                }\r\n            </div>\r\n        );\r\n    }\r\n}","import { Observable, ObservableFactory } from \"../common/Observable\";\r\nimport { ResourceSystem } from \"./resources/ResourceSystem\";\r\nimport { WorkerSystem } from \"./workers/WorkerSystem\";\r\nimport { BuildingSystem } from \"./buildings/BuildingSystem\";\r\n\r\nexport class Game {\r\n    private updateFrequency: number = 100;\r\n    private maxTimeToResumePerUpdate: number = 24 * 60 * 60 * 1000;\r\n\r\n    private updateIntervalID: number;\r\n    private lastUpdateAsNumber: number = Date.now();\r\n    \r\n    private startTimeAsNumber: number;\r\n\r\n    public buildingSystem: BuildingSystem;\r\n    public resourceSystem: ResourceSystem;\r\n    public workerSystem: WorkerSystem;\r\n\r\n    public onUpdated: Observable = ObservableFactory.create();\r\n\r\n    public static new(): Game {\r\n        const game = new Game();\r\n        game.init();\r\n        game.startNewGame();\r\n        return game;\r\n    }\r\n\r\n    private constructor () {}\r\n\r\n    public init (): void {\r\n        this.buildingSystem = new BuildingSystem(this);\r\n        this.buildingSystem.init();\r\n\r\n        this.resourceSystem = new ResourceSystem();\r\n        this.resourceSystem.init();\r\n\r\n        this.workerSystem = new WorkerSystem(this);\r\n        this.workerSystem.init();\r\n    }\r\n\r\n    public startNewGame (): void {\r\n        this.startTimeAsNumber = Date.now();\r\n        this.workerSystem.newGame();\r\n        this.refreshSystemsIsUnlocked();\r\n        this.resourceSystem.refreshResourcesIsUnlocked();\r\n        this.beginUpdating();\r\n    }\r\n\r\n    private beginUpdating(): void {\r\n        this.updateIntervalID = setInterval(() => {\r\n            this.update();\r\n        }, this.updateFrequency);\r\n    }\r\n\r\n    private update (): void {\r\n        let timeSinceLastUpdate = Date.now() - this.lastUpdateAsNumber;\r\n\r\n        // Cap catch up duration\r\n        if (timeSinceLastUpdate > this.maxTimeToResumePerUpdate) {\r\n            timeSinceLastUpdate = this.maxTimeToResumePerUpdate;\r\n            this.lastUpdateAsNumber = Date.now() - this.maxTimeToResumePerUpdate;\r\n        }\r\n\r\n        // Update until caught up\r\n        while (timeSinceLastUpdate > this.updateFrequency) {\r\n            timeSinceLastUpdate -= this.updateFrequency;\r\n            this.lastUpdateAsNumber = this.lastUpdateAsNumber + this.updateFrequency;\r\n\r\n            this.updateGameSystems(this.updateFrequency);\r\n        }\r\n\r\n        this.onUpdated.notify();\r\n    }\r\n\r\n    private updateGameSystems (dTime: number): void {        \r\n        this.resourceSystem.update(dTime);\r\n    }\r\n\r\n    private refreshSystemsIsUnlocked() {\r\n        this.workerSystem.isUnlocked = true;\r\n        this.resourceSystem.isUnlocked = true;\r\n        this.buildingSystem.isUnlocked = this.workerSystem.totalWorkerCount.value > 1 || this.workerSystem.idleWorkerCount === 0;\r\n    }\r\n}","export class ObservableSubscription {\r\n    public observer: object;\r\n    public callback: (...args: any[]) => void;\r\n    public constructor (observer: object, callback: (...args: any[]) => void) {\r\n        this.observer = observer;\r\n        this.callback = callback;\r\n    }\r\n}","import { GameSystem } from \"../shared/GameSystem\";\r\nimport { Resource } from \"./Resource\";\r\nimport { ResourceType } from \"./ResourceType\";\r\nimport { ResourceValue } from \"./ResourceValue\";\r\n\r\nexport class ResourceSystem extends GameSystem {\r\n    public name: string = 'Resources';\r\n    public resources: Resource[] = [];\r\n    public resourceMap: Map<ResourceType, Resource> = new Map();\r\n    public resourceCaps: ResourceValue[] = [];\r\n    private addResourceType(name: string, type: ResourceType, initialCap?: number): void {\r\n        this.resources.push(new Resource(name, type, initialCap));\r\n    }\r\n    public init(): void {\r\n        this.addResourceType(\"Food\", ResourceType.Food, 500);\r\n        this.addResourceType(\"Wood\", ResourceType.Wood, 500);\r\n        this.addResourceType(\"Stone\", ResourceType.Stone, 100);\r\n        this.addResourceType(\"Pelt\", ResourceType.Pelt, 100);\r\n        this.addResourceType(\"Gold\", ResourceType.Gold, 100);\r\n        this.addResourceType(\"Devotion\", ResourceType.Devotion);\r\n\r\n        this.resources.forEach(resource => this.resourceMap.set(resource.type, resource));\r\n    }\r\n    public getResource(type: ResourceType): Resource {\r\n        return this.resourceMap.get(type);\r\n    }\r\n    public update(dTime: number): void {\r\n        this.resources.forEach(resource => {\r\n            const dAmount = resource.income.value * dTime / 1000;\r\n            resource.amount += dAmount;\r\n            resource.respectCap();\r\n        });\r\n    }\r\n    public hasResources(resourceValues: ResourceValue[]): boolean {\r\n        return resourceValues.every(resourceValue => {\r\n            const resource = this.getResource(resourceValue.resourceType);\r\n            return resource.amount >= resourceValue.value.value;\r\n        });\r\n    }\r\n    public payResources(resourceValues: ResourceValue[]): void {\r\n        return resourceValues.forEach(resourceValue => {\r\n            const resource = this.getResource(resourceValue.resourceType);\r\n            resource.amount -= resourceValue.value.value;\r\n        });\r\n    }\r\n    public refreshResourcesIsUnlocked(): void {\r\n        this.resourceMap.get(ResourceType.Food).isUnlocked = true;\r\n        this.resourceMap.get(ResourceType.Wood).isUnlocked = true;\r\n    }\r\n}\r\n","import { ValueContainer } from \"../shared/ValueContainer\";\r\nimport { ResourceType } from \"./ResourceType\";\r\nimport { Observable, ObservableFactory } from \"../../common/Observable\";\r\n\r\nexport class Resource {\r\n    private _isUnlocked: boolean = false;\r\n    public get isUnlocked(): boolean { return this._isUnlocked; };\r\n    public set isUnlocked(value) { \r\n        if (this._isUnlocked !== value) {\r\n            this._isUnlocked = value;\r\n            if (value) {\r\n                this.onUnlocked.notify();\r\n            }\r\n        }\r\n    };\r\n    public onUnlocked: Observable = ObservableFactory.create();\r\n    public amount: number = 0;\r\n    public income: ValueContainer = new ValueContainer();\r\n    public cap: ValueContainer = new ValueContainer();\r\n    public hasCap: boolean;\r\n    public name: string;\r\n    public type: ResourceType;\r\n    public constructor(name: string, type: ResourceType, initialCap?: number) {\r\n        this.name = name;\r\n        this.type = type;\r\n        if (initialCap === undefined) {\r\n            this.hasCap = false;\r\n        } else {\r\n            this.hasCap = true;\r\n            this.cap.setAdditiveModifier(this, initialCap);\r\n        }\r\n    }\r\n\r\n    public respectCap(): void {\r\n        if (this.hasCap && this.amount > this.cap.value) {\r\n            this.amount = this.cap.value;\r\n        }\r\n    }\r\n}","import { GameSystem } from \"../shared/GameSystem\";\r\nimport { ObservableWith1Argument, ObservableFactory } from \"../../common/Observable\";\r\nimport { ResourceJob } from \"./ResourceJob\";\r\nimport { ResourceType } from \"../resources/ResourceType\";\r\nimport { Game } from \"../Game\";\r\nimport { Job } from \"./Job\";\r\nimport { ValueContainer } from \"../shared/ValueContainer\";\r\n\r\nexport class WorkerSystem extends GameSystem {\r\n    private game: Game;\r\n\r\n    public name: string = 'Workers';\r\n    public idleWorkerCount: number;\r\n    public totalWorkerCount: ValueContainer;\r\n    public onIdleWorkerCountChange: ObservableWith1Argument<number>;\r\n\r\n    public gathererJob: ResourceJob;\r\n    public woodcutterJob: ResourceJob;\r\n    public resourceJobs: ResourceJob[];\r\n\r\n    public jobs: Job[];\r\n\r\n    public constructor (game: Game) {\r\n        super();\r\n        this.game = game;\r\n    }\r\n\r\n    public init(): void {\r\n        this.totalWorkerCount = new ValueContainer();\r\n        this.totalWorkerCount.setAdditiveModifier(this, 1);\r\n        this.totalWorkerCount.onValueChange.addSubscription(this, _ => this.recalculateIdleWorkerCount());\r\n\r\n        this.gathererJob = new ResourceJob(\"Gatherer\", \"Search nearby forests for berries and shrooms\", 0.5, ResourceType.Food);\r\n        this.woodcutterJob = new ResourceJob(\"Woodcutter\", \"Chop down trees for wood\", 25, ResourceType.Wood);\r\n        this.resourceJobs = [\r\n            this.gathererJob,\r\n            this.woodcutterJob\r\n        ];\r\n\r\n        this.jobs = [...this.resourceJobs];\r\n\r\n        // Bind resource jobs to resources\r\n        this.resourceJobs.forEach(job => {\r\n            const resource = this.game.resourceSystem.getResource(job.resourceType);\r\n            job.onWorkerCountChange.addSubscription(this, (workerCount: number) => {\r\n                const resourceIncomeFromJob = workerCount * job.value.value;\r\n                resource.income.setAdditiveModifier(job, resourceIncomeFromJob);\r\n            });\r\n        });\r\n\r\n        this.onIdleWorkerCountChange = ObservableFactory.createWith1Argument<number>();\r\n    }\r\n\r\n    public newGame(): void {\r\n        this.recalculateIdleWorkerCount();\r\n    }\r\n\r\n    public recalculateIdleWorkerCount(): void {\r\n        let newCount = this.totalWorkerCount.value;\r\n        this.jobs.forEach(job => newCount -= job.workerCount);\r\n        if (this.idleWorkerCount !== newCount) {\r\n            this.idleWorkerCount = newCount;\r\n            this.onIdleWorkerCountChange.notify(this.idleWorkerCount);\r\n        }\r\n    }\r\n\r\n    public setWorkerCountOnJob(job: Job, workerCount: number) {\r\n        const dWorkerCount = workerCount - job.workerCount;\r\n        if (dWorkerCount > 0) {\r\n            if (this.idleWorkerCount >= dWorkerCount) {\r\n                job.workerCount += dWorkerCount;\r\n            } else {\r\n                throw `Cannot assign ${dWorkerCount} workers - only ${this.idleWorkerCount} workers available.`;\r\n            }\r\n        } else {\r\n            if (workerCount >= 0) {\r\n                job.workerCount += dWorkerCount;\r\n            } else {\r\n                throw `Cannot assign a negative amount of workers to a job`;\r\n            }\r\n        }\r\n        this.game.buildingSystem.isUnlocked = true;\r\n        this.recalculateIdleWorkerCount();\r\n    }\r\n}","import { ResourceType } from \"../resources/ResourceType\";\r\nimport { Job } from \"./Job\";\r\n\r\nexport class ResourceJob extends Job {\r\n    public resourceType: ResourceType;\r\n\r\n    public constructor(name: string, description: string, incomePerSecond: number, resourceType: ResourceType) {\r\n        super(name, description, incomePerSecond);\r\n        this.resourceType = resourceType;\r\n    }\r\n}","import { ValueContainer } from \"../shared/ValueContainer\";\r\nimport { ObservableFactory, ObservableWith1Argument } from \"../../common/Observable\";\r\n\r\nexport class Job {\r\n    constructor (name: string, description: string, value: number) {\r\n        this._workerCount = 0;\r\n\r\n        this.name = name;\r\n        this.description = description;\r\n        this.value = new ValueContainer();\r\n        this.value.setAdditiveModifier(this, value);\r\n        this.onWorkerCountChange = ObservableFactory.createWith1Argument<number>();\r\n    }\r\n    public name: string;\r\n    public description: string;\r\n    public value: ValueContainer;\r\n    public onWorkerCountChange: ObservableWith1Argument<number>;\r\n\r\n    private _workerCount: number;\r\n    public get workerCount(): number {\r\n        return this._workerCount;\r\n    }\r\n    public set workerCount(value: number) {\r\n        this._workerCount = value;\r\n        this.onWorkerCountChange.notify(value);\r\n    }\r\n}","import { GameSystem } from \"../shared/GameSystem\";\r\nimport { Building } from \"./Building\";\r\nimport { ResourceValue } from \"../resources/ResourceValue\";\r\nimport { ResourceType } from \"../resources/ResourceType\";\r\nimport { Game } from \"../Game\";\r\n\r\nexport class BuildingSystem extends GameSystem {\r\n    private game: Game;\r\n    public name: string = 'Buildings';\r\n    public buildings: Building[] = [];\r\n    public constructor(game: Game) {\r\n        super();\r\n        this.game = game;\r\n    }\r\n    private addBuilding(\r\n        name: string,\r\n        description: string,\r\n        baseCost: ResourceValue[],\r\n        additiveCostPerBuilding: ResourceValue[],\r\n        multiplicativeCostPerBuilding: ResourceValue[],\r\n        onUpdateAmount: (thisBuilding: Building) => void\r\n    ): void {\r\n        this.buildings.push(new Building(name, description, baseCost, additiveCostPerBuilding, multiplicativeCostPerBuilding, onUpdateAmount));\r\n    }\r\n    private buildResourceValues(...resourceValueInput: [ResourceType, number][]): ResourceValue[] {\r\n        return resourceValueInput.map(input => new ResourceValue(input[0], input[1]));\r\n    }\r\n    public init(): void {\r\n        this.addBuilding(\r\n            'Hut', \r\n            'Allows another worker to join your village',\r\n            this.buildResourceValues([ResourceType.Wood, 100]),\r\n            this.buildResourceValues([ResourceType.Wood, 20]),\r\n            this.buildResourceValues([ResourceType.Wood, 1.2]),\r\n            (thisBuilding: Building): void => {\r\n              this.game.workerSystem.totalWorkerCount.setAdditiveModifier(thisBuilding, thisBuilding.amount);\r\n            }\r\n        );\r\n    }\r\n    public buyBuilding(building: Building): void {\r\n        const cost = building.getCostOfNextBuilding();\r\n        if (this.game.resourceSystem.hasResources(cost)) {\r\n            this.game.resourceSystem.payResources(cost);\r\n            building.incrementAmount();\r\n        }\r\n    }\r\n}","import { ResourceValue } from \"../resources/ResourceValue\";\r\nimport { ObservableFactory, ObservableWith1Argument } from \"../../common/Observable\";\r\n\r\nexport class Building {\r\n    public onUpdateAmount: ObservableWith1Argument<Building>;\r\n    public amount: number;\r\n    public name: string;\r\n    public description: string;\r\n    public baseCost: ResourceValue[];\r\n    public additiveCostPerBuilding: ResourceValue[];\r\n    public multiplicativeCostPerBuilding: ResourceValue[];\r\n    public constructor(\r\n        name: string,\r\n        description: string,\r\n        baseCost: ResourceValue[],\r\n        additiveCostPerBuilding: ResourceValue[],\r\n        multiplicativeCostPerBuilding: ResourceValue[],\r\n        onUpdateAmount: (thisBuilding: Building) => void\r\n    ) {\r\n        this.amount = 0;\r\n        this.name = name;\r\n        this.description = description;\r\n        this.baseCost = baseCost;\r\n        this.additiveCostPerBuilding = additiveCostPerBuilding;\r\n        this.multiplicativeCostPerBuilding = multiplicativeCostPerBuilding;\r\n        this.onUpdateAmount = ObservableFactory.createWith1Argument<Building>();\r\n        this.onUpdateAmount.addSubscription(this, onUpdateAmount);\r\n    }\r\n    public incrementAmount() {\r\n        this.amount++;\r\n        this.onUpdateAmount.notify(this);\r\n    }\r\n    public getCostOfNextBuilding(): ResourceValue[] {\r\n        const cost: ResourceValue[] = [];\r\n        this.baseCost.forEach(c => cost.push(new ResourceValue(c.resourceType, c.value.value)));\r\n        this.additiveCostPerBuilding.forEach(c => {\r\n            const value = this.amount * c.value.value;\r\n            if (value > 0) {\r\n                const costResource = cost.find(resource => resource.resourceType === c.resourceType);\r\n                if (costResource) {\r\n                    costResource.value.setAdditiveModifier(c, value);\r\n                } else {\r\n                    cost.push(new ResourceValue(c.resourceType, value));\r\n                }\r\n            }\r\n        });\r\n        this.multiplicativeCostPerBuilding.forEach(c => {\r\n            const value = Math.pow(c.value.value, this.amount);\r\n            if (value > 0) {\r\n                const costResource = cost.find(resource => resource.resourceType === c.resourceType);\r\n                if (costResource) {\r\n                    costResource.value.setMultiplicativeModifier(c, value);\r\n                }\r\n            }\r\n        });\r\n        return cost;\r\n    }\r\n}\r\n","import React = require(\"react\");\r\nimport { Game } from \"../../../game/Game\";\r\n\r\nexport const GameContext = React.createContext<Game>(null);\r\n","import React = require(\"react\");\r\n\r\nexport class UIHeader extends React.Component<{versionNumber: string, onNewGameClick: () => void}> {\r\n    public render(): JSX.Element {\r\n        return (\r\n            <div id=\"header\">\r\n                <span className=\"title-container\">\r\n                    <span className=\"title\">Quiet Village</span>\r\n                    <span className=\"version-number\">v{this.props.versionNumber}</span>\r\n                </span>\r\n                <span className=\"button btn-new-game\" onClick={this.props.onNewGameClick}>New game</span>\r\n            </div>\r\n        );\r\n    }\r\n}","import React = require(\"react\");\r\nimport { Game } from \"../../../../game/Game\";\r\nimport { UIJobList } from \"../workers/UIJobList\";\r\nimport { UIBuildings } from \"../buildings/UIBuildings\";\r\nimport { UIResources } from \"../resources/UIResources\";\r\nimport { UIGameSystemTabs } from \"./UIGameSystemTabs\";\r\nimport { GameSystem } from \"../../../../game/shared/GameSystem\";\r\n\r\nexport class UIBody extends React.Component<{game: Game},{selectedGameSystem: GameSystem}> {\r\n    // public constructor(props:{game: Game}) {\r\n    //     super(props);\r\n    //     this.state = {selectedGameSystem: props.game.workerSystem};\r\n    // }\r\n    private renderGameSystem(): JSX.Element {\r\n        if (!this.state || !this.state.selectedGameSystem || !this.state.selectedGameSystem.isUnlocked) {\r\n            return null;\r\n        }\r\n\r\n        switch(this.state.selectedGameSystem) {\r\n            case this.props.game.buildingSystem:\r\n                return <UIBuildings game={this.props.game}></UIBuildings>\r\n            case this.props.game.workerSystem:\r\n                return <UIJobList game={this.props.game}></UIJobList>\r\n            default: \r\n                return null;\r\n        }\r\n    }\r\n    public render(): JSX.Element {\r\n        return (\r\n            <div id=\"body\">\r\n                <span id=\"tabs-and-tab-content-container\">\r\n                    <UIGameSystemTabs \r\n                        game={this.props.game} \r\n                        onSelected={(system: GameSystem)=>this.setState({selectedGameSystem:system})}\r\n                    ></UIGameSystemTabs>\r\n                    <span id=\"tab-content\">\r\n                        {this.renderGameSystem()}\r\n                    </span>\r\n                </span>\r\n                <UIResources game={this.props.game}></UIResources>\r\n            </div>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { UIJobLine } from \"./UIJobLine\";\r\nimport { Game } from \"../../../../game/Game\";\r\n\r\nexport class UIJobList extends React.Component<{game: Game}> {\r\n    constructor (props: {game: Game}) {\r\n        super(props);\r\n    }\r\n    render() {\r\n        return (\r\n            <ul>\r\n            {this.props.game.workerSystem.jobs.map((job) => \r\n                <UIJobLine key={job.name} game={this.props.game} job={job}>\r\n                </UIJobLine>\r\n            )}\r\n            </ul>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Job } from \"../../../../game/workers/Job\";\r\nimport { Game } from \"../../../../game/Game\";\r\n\r\ninterface JobLine {\r\n    name: string,\r\n    workerCount: number\r\n}\r\nexport class UIJobLine extends React.Component<{game: Game, job: Job}, JobLine> {\r\n    public constructor (props: {game: Game, job: Job}) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            name: this.props.job.name,\r\n            workerCount: this.props.job.workerCount\r\n        };\r\n\r\n        this.props.job.onWorkerCountChange.addSubscription(\r\n            this,\r\n            (newWorkerCount: number) => \r\n                this.setState({workerCount: newWorkerCount}));\r\n    }\r\n    private addWorker (): void {\r\n        const newWorkerCount = this.props.job.workerCount + 1;\r\n        this.setWorkers(newWorkerCount);\r\n    }\r\n    private removeWorker (): void {\r\n        const newWorkerCount = this.props.job.workerCount - 1;\r\n        this.setWorkers(newWorkerCount);\r\n    }\r\n    private setWorkers(newWorkerCount: number): void {\r\n        this.props.game.workerSystem.setWorkerCountOnJob(this.props.job, newWorkerCount);\r\n    }\r\n    public render(): JSX.Element {\r\n        return (\r\n            <li key={this.state.name}>\r\n                <span>{this.state.name}</span>\r\n                <span>{this.state.workerCount}</span>\r\n                <input type=\"button\" onClick={()=>this.addWorker()} value=\"Add\"/>\r\n                <input type=\"button\" onClick={()=>this.removeWorker()} value=\"Remove\"/>\r\n            </li>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Game } from \"../../../../game/Game\";\r\nimport { UIBuilding } from \"./UIBuilding\";\r\n\r\nexport class UIBuildings extends React.Component<{game: Game}> {\r\n    constructor (props: {game: Game}) {\r\n        super(props);\r\n    }\r\n    render() {\r\n        return (\r\n            <ul>\r\n            {this.props.game.buildingSystem.buildings.map((building) => \r\n                <UIBuilding key={building.name} game={this.props.game} building={building}>\r\n                </UIBuilding>\r\n            )}\r\n            </ul>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Game } from \"../../../../game/Game\";\r\nimport { Building } from \"../../../../game/buildings/Building\";\r\n\r\ninterface BuildingLine {\r\n    name: string,\r\n    amount: number\r\n}\r\nexport class UIBuilding extends React.Component<{game: Game, building: Building}, BuildingLine> {\r\n    public constructor (props: {game: Game, building: Building}) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            name: this.props.building.name,\r\n            amount: this.props.building.amount\r\n        };\r\n\r\n        this.props.building.onUpdateAmount.addSubscription(\r\n            this,\r\n            (thisBuilding: Building) => \r\n                this.setState({amount: thisBuilding.amount}));\r\n    }\r\n    private buy (): void {\r\n        this.props.game.buildingSystem.buyBuilding(this.props.building);\r\n    }\r\n    public render(): JSX.Element {\r\n        return (\r\n            <li key={this.state.name}>\r\n                <span>{this.state.name}</span>\r\n                <span>{this.state.amount}</span>\r\n                <input type=\"button\" onClick={()=>this.buy()} value=\"Buy\"/>\r\n            </li>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Game } from \"../../../../game/Game\";\r\nimport { UIResource } from \"./UIResource\";\r\nimport { Resource } from \"../../../../game/resources/Resource\";\r\n\r\nexport class UIResources extends React.Component<{game: Game}, {resources: Resource[]}> {\r\n    constructor (props: {game: Game}) {\r\n        super(props);\r\n\r\n        const getResources = () => this.props.game.resourceSystem.resources\r\n            .filter(resource => resource.isUnlocked);\r\n\r\n        this.state = {resources: getResources()};\r\n\r\n        this.props.game.onUpdated.addSubscription(\r\n            this, \r\n            () => this.setState({resources: getResources()})\r\n        );\r\n    }\r\n    render() {\r\n        return (\r\n            <ul id=\"resource-list\">\r\n            {this.state.resources.map((resource) => \r\n                <UIResource key={resource.name} resource={resource}></UIResource>\r\n            )}\r\n            </ul>\r\n        );\r\n    }\r\n}","import * as React from \"react\";\r\nimport { NumberFormatter } from \"../../../../common/NumberFormatter\";\r\nimport { Resource } from \"../../../../game/resources/Resource\";\r\n\r\nexport class UIResource extends React.Component<{resource: Resource}> {\r\n    render() {\r\n        return (\r\n            <li className=\"resource-line\">\r\n                <span>\r\n                    <span className=\"name\">{this.props.resource.name}</span>\r\n                    <span className=\"increase-per-second\">({NumberFormatter.Format(this.props.resource.income.value, 2, 2)}/s)</span>\r\n                </span>\r\n                <span>\r\n                    <span className=\"amount\">{NumberFormatter.Format(this.props.resource.amount, 2, 2)}</span>\r\n                    {\r\n                        this.props.resource.hasCap\r\n                        ? <span> / {NumberFormatter.Format(this.props.resource.cap.value, 2, 2)}</span>\r\n                        : null\r\n                    }\r\n                </span>\r\n            </li>\r\n        );\r\n    }\r\n}","export class NumberFormatter {\r\n    public static postfixes = ['', 'k', 'm', 'b'];\r\n    public static Format(number: number, maxDecimals?: number, minDecimals?: number, ceil?: boolean): string {\r\n        if (maxDecimals === undefined) {\r\n            maxDecimals = 2;\r\n        }\r\n        if (minDecimals === undefined) {\r\n            minDecimals = maxDecimals;\r\n        }\r\n        if (ceil === undefined) {\r\n            ceil = false;\r\n        }\r\n\r\n        let amountOfTimesTheNumberCanBeDividedBy1000 = 0;\r\n        while(number > 10000) {\r\n            number /= 1000;\r\n            amountOfTimesTheNumberCanBeDividedBy1000++;\r\n        }\r\n\r\n        const multiplier = Math.pow(10, maxDecimals);\r\n        let roundedNumber;\r\n        if (ceil) {\r\n            number -= 0.0001; // Floating point fix.\r\n            roundedNumber = Math.ceil(number * multiplier) / multiplier;\r\n        } else {\r\n            number += 0.0001; // Floating point fix.\r\n            roundedNumber = Math.floor(number * multiplier) / multiplier;\r\n        }\r\n\r\n        let numberString: string;\r\n        if (minDecimals) {\r\n            numberString = roundedNumber.toFixed(minDecimals);\r\n        } else {\r\n            numberString = roundedNumber.toString();\r\n        }\r\n\r\n        const postfix = NumberFormatter.postfixes[amountOfTimesTheNumberCanBeDividedBy1000];\r\n        if (postfix) {\r\n            numberString += postfix;\r\n        }\r\n        return numberString;\r\n    }\r\n}","import React = require(\"react\");\r\nimport { Game } from \"../../../../game/Game\";\r\nimport { GameSystem } from \"../../../../game/shared/GameSystem\";\r\nimport { UIGameSystemTab } from \"./UIGameSystemTab\";\r\n\r\nexport class UIGameSystemTabs extends React.Component<{game: Game, onSelected: (system: GameSystem)=>void}> {\r\n    private gameSystems: GameSystem[];\r\n    private allGameSystems: GameSystem[];\r\n    private selectedGameSystem: GameSystem;\r\n    public constructor(props: {game: Game, onSelected: (system: GameSystem)=>void}) {\r\n        super(props);\r\n\r\n        this.allGameSystems = [\r\n            props.game.workerSystem,\r\n            props.game.buildingSystem\r\n        ];\r\n\r\n        this.allGameSystems.forEach(system => system.onUnlocked.addSubscription(this, () => this.updateGameSystems()));\r\n\r\n        this.gameSystems = this.getUnlockedGameSystems();\r\n    }\r\n    private getUnlockedGameSystems(): GameSystem[] {\r\n        return this.allGameSystems.filter(system => system.isUnlocked);\r\n    }\r\n    private updateGameSystems(): void {\r\n        this.gameSystems = this.allGameSystems.filter(system => system.isUnlocked);\r\n        this.forceUpdate();\r\n    }\r\n    private selectGameSystem(gameSystem: GameSystem): void {\r\n        this.selectedGameSystem = gameSystem;\r\n        this.props.onSelected(gameSystem);\r\n        this.forceUpdate();\r\n    }\r\n    public componentDidMount () {\r\n        this.selectGameSystem(this.props.game.workerSystem);\r\n    }\r\n    public render(): JSX.Element {\r\n        return (\r\n            <ul id=\"tabs\">\r\n                {this.gameSystems.map(system => \r\n                    <UIGameSystemTab \r\n                        key={system.name}\r\n                        gameSystem={system} \r\n                        isSelected={system === this.selectedGameSystem}\r\n                        onSelected={()=>this.selectGameSystem(system)}\r\n                    ></UIGameSystemTab>\r\n                )}\r\n            </ul>\r\n        );\r\n    }\r\n}","import React = require(\"react\");\r\nimport { GameSystem } from \"../../../../game/shared/GameSystem\";\r\n\r\nexport class UIGameSystemTab extends React.Component<{gameSystem: GameSystem, isSelected: boolean, onSelected: () => void}> {\r\n    public render(): JSX.Element {\r\n        return (\r\n            <li className={`tab ${this.props.isSelected ? 'selected' : ''}`} onClick={this.props.onSelected}>\r\n                <img src={`./img/tabs/${this.props.gameSystem.name.toLocaleLowerCase()}.png`}/>\r\n                <span>{this.props.gameSystem.name}</span>\r\n            </li>\r\n        );\r\n    }\r\n}\r\n"],"sourceRoot":""}